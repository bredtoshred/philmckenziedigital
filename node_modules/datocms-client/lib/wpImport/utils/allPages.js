"use strict";

/* eslint-disable */
var _require = require('../utils/progress'),
    spin = _require.spin,
    progress = _require.progress;

var allPages = function allPages(label, requestPromise) {
  var tick,
      page,
      response,
      nextPage,
      _args = arguments;
  return regeneratorRuntime.async(function allPages$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          tick = _args.length > 2 && _args[2] !== undefined ? _args[2] : null;
          page = _args.length > 3 && _args[3] !== undefined ? _args[3] : 1;
          _context.next = 4;
          return regeneratorRuntime.awrap(tick ? tick('', requestPromise) : spin(label, requestPromise));

        case 4:
          response = _context.sent;

          if (!(!response._paging || response._paging.totalPages <= page)) {
            _context.next = 7;
            break;
          }

          return _context.abrupt("return", response);

        case 7:
          nextPage = response._paging.next.page(page + 1);
          _context.t0 = response;
          _context.next = 11;
          return regeneratorRuntime.awrap(allPages(label, nextPage, tick || progress(label, response._paging.totalPages - 1), page + 1));

        case 11:
          _context.t1 = _context.sent;
          return _context.abrupt("return", _context.t0.concat.call(_context.t0, _context.t1));

        case 13:
        case "end":
          return _context.stop();
      }
    }
  });
};

module.exports = allPages;