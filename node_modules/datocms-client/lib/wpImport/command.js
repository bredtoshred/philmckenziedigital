"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = command;

var _wpapi = _interopRequireDefault(require("wpapi"));

var _SiteClient = _interopRequireDefault(require("../site/SiteClient"));

var _destroyExistingData = _interopRequireDefault(require("./destroyExistingData"));

var _createSchema = _interopRequireDefault(require("./createSchema"));

var _media = _interopRequireDefault(require("./import/media"));

var _authors = _interopRequireDefault(require("./import/authors"));

var _categories = _interopRequireDefault(require("./import/categories"));

var _tags = _interopRequireDefault(require("./import/tags"));

var _articles = _interopRequireDefault(require("./import/articles"));

var _pages = _interopRequireDefault(require("./import/pages"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function command(token, wpUrl, wpUser, wpPassword) {
  var dato, wp, schema, media, categories, tags, authors;
  return regeneratorRuntime.async(function command$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          dato = new _SiteClient["default"](token);
          _context.next = 3;
          return regeneratorRuntime.awrap(_wpapi["default"].discover(wpUrl));

        case 3:
          wp = _context.sent;
          _context.next = 6;
          return regeneratorRuntime.awrap(wp.auth({
            username: wpUser,
            password: wpPassword
          }));

        case 6:
          _context.next = 8;
          return regeneratorRuntime.awrap((0, _destroyExistingData["default"])(dato, wp));

        case 8:
          _context.next = 10;
          return regeneratorRuntime.awrap((0, _createSchema["default"])(dato, wp));

        case 10:
          schema = _context.sent;
          _context.next = 13;
          return regeneratorRuntime.awrap((0, _media["default"])(dato, wp));

        case 13:
          media = _context.sent;
          _context.next = 16;
          return regeneratorRuntime.awrap((0, _categories["default"])(dato, wp, schema.categoryId));

        case 16:
          categories = _context.sent;
          _context.next = 19;
          return regeneratorRuntime.awrap((0, _tags["default"])(dato, wp, schema.tagId));

        case 19:
          tags = _context.sent;
          _context.next = 22;
          return regeneratorRuntime.awrap((0, _authors["default"])(dato, wp, schema.authorId));

        case 22:
          authors = _context.sent;
          _context.next = 25;
          return regeneratorRuntime.awrap((0, _articles["default"])(dato, wp, schema, media, categories, tags, authors));

        case 25:
          _context.next = 27;
          return regeneratorRuntime.awrap((0, _pages["default"])(dato, wp, schema, media, authors));

        case 27:
        case "end":
          return _context.stop();
      }
    }
  });
}